(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{85430:function(e,t,s){Promise.resolve().then(s.bind(s,83996))},37211:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(87461).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},83996:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return z}});var n=s(3827),r=s(64090),i=s(87461);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,i.Z)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),a=(0,i.Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),c=(0,i.Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var d=s(44715);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,i.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),m=(0,i.Z)("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);var x=s(52235),h=s(29733),u=s(10775),p=s(37211);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let g=(0,i.Z)("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);var f=s(49108),j=s(37805);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let N=(0,i.Z)("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);var y=s(22169),b=s(5080),v=s(15671),w=s(575),k=s(33277),C=s(59547),P=s(43528);let S="http://localhost:8000".replace(/\/api\/?$/,"")||"";function z(){var e;let[t,s]=r.useState(1),[i,z]=r.useState(20),[T,Z]=r.useState({field:"entryTime",direction:"desc"}),[D,L]=r.useState({search:"",instruments:[],direction:"all",outcome:"all"}),[_,M]=r.useState(!1),{formatAmount:q}=(0,b.ux)(),{dateRange:U,recentTrades:F,loading:E,setDateRange:A,setRecentTrades:Y,setLoading:R,isInitialized:I,setInitialized:O}=(0,P.Ln)();r.useEffect(()=>{(async()=>{R("recentTrades",!0);try{let e=await fetch("".concat(S,"/api/trades/recent?limit=100"));if(e.ok){let t=(await e.json()).map(e=>({id:e.id||e.transaction_id,instrument:e.instrument||e.description,direction:e.direction||"long",entryPrice:e.entry_price||e.entryPrice||0,exitPrice:e.exit_price||e.exitPrice||0,entryTime:new Date(e.entry_time||e.entryTime||e.open_period||Date.now()),exitTime:new Date(e.exit_time||e.exitTime||e.transaction_date||Date.now()),quantity:e.quantity||e.amount||1,pnl:e.pnl||e.pl||0,pnlPercent:e.pnl_percent||e.pnlPercent||0,currency:e.currency}));Y(t)}O(!0)}finally{R("recentTrades",!1)}})()},[R,Y,O]);let V=r.useMemo(()=>Array.from(new Set(F.map(e=>e.instrument))).sort(),[F]),W=r.useMemo(()=>F.filter(e=>{if(D.search){let t=D.search.toLowerCase();if(!e.instrument.toLowerCase().includes(t)&&!e.id.toLowerCase().includes(t))return!1}if(D.instruments.length>0&&!D.instruments.includes(e.instrument)||"all"!==D.direction&&e.direction!==D.direction)return!1;if("all"!==D.outcome){let t=e.pnl>=0;if("win"===D.outcome&&!t||"loss"===D.outcome&&t)return!1}return!0}),[F,D]),H=r.useMemo(()=>[...W].sort((e,t)=>{let s,n;switch(T.field){case"entryTime":s=new Date(e.entryTime).getTime(),n=new Date(t.entryTime).getTime();break;case"instrument":s=e.instrument,n=t.instrument;break;case"direction":s=e.direction,n=t.direction;break;case"pnl":s=e.pnl,n=t.pnl;break;case"pnlPercent":s=e.pnlPercent,n=t.pnlPercent;break;default:return 0}return s<n?"asc"===T.direction?-1:1:s>n?"asc"===T.direction?1:-1:0}),[W,T]),$=r.useMemo(()=>{let e=(t-1)*i;return H.slice(e,e+i)},[H,t,i]),B=Math.ceil(H.length/i),G=(t-1)*i+1,J=Math.min(t*i,H.length),K=e=>{Z(t=>({field:e,direction:t.field===e&&"asc"===t.direction?"desc":"asc"}))},Q=e=>T.field!==e?(0,n.jsx)(l,{className:"h-4 w-4 opacity-50"}):"asc"===T.direction?(0,n.jsx)(a,{className:"h-4 w-4"}):(0,n.jsx)(c,{className:"h-4 w-4"}),X=()=>{L({search:"",instruments:[],direction:"all",outcome:"all"})},ee=D.search||D.instruments.length>0||"all"!==D.direction||"all"!==D.outcome,et=r.useMemo(()=>{let e=W.reduce((e,t)=>e+t.pnl,0),t=W.filter(e=>e.pnl>=0).length,s=W.filter(e=>e.pnl<0).length,n=W.length>0?t/W.length*100:0;return{totalPnl:e,wins:t,losses:s,winRate:n,total:W.length}},[W]);return(0,n.jsx)("div",{className:"min-h-screen bg-background p-6 md:p-8",children:(0,n.jsxs)("div",{className:"container mx-auto max-w-7xl",children:[(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Transactions"}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:"View and analyze all your trading transactions"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(C.D,{dateRange:{from:U.from,to:U.to,preset:U.preset},onDateRangeChange:e=>{A({from:e.from,to:e.to,preset:e.preset||"custom"})}}),(0,n.jsxs)(w.z,{variant:"outline",size:"sm",className:"gap-2",children:[(0,n.jsx)(d.Z,{className:"h-4 w-4"}),"Export"]})]})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,n.jsx)(v.Zb,{children:(0,n.jsxs)(v.aY,{className:"pt-4 pb-4",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Trades"}),(0,n.jsx)("p",{className:"text-2xl font-bold",children:et.total})]})}),(0,n.jsx)(v.Zb,{children:(0,n.jsxs)(v.aY,{className:"pt-4 pb-4",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total P&L"}),(0,n.jsx)("p",{className:(0,y.cn)("text-2xl font-bold",et.totalPnl>=0?"text-green-500":"text-red-500"),children:(null===(e=W[0])||void 0===e?void 0:e.currency)?q(et.totalPnl,W[0].currency):et.totalPnl.toLocaleString("en-US",{minimumFractionDigits:2})})]})}),(0,n.jsx)(v.Zb,{children:(0,n.jsxs)(v.aY,{className:"pt-4 pb-4",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Win Rate"}),(0,n.jsxs)("p",{className:"text-2xl font-bold",children:[et.winRate.toFixed(1),"%"]})]})}),(0,n.jsx)(v.Zb,{children:(0,n.jsxs)(v.aY,{className:"pt-4 pb-4",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Wins / Losses"}),(0,n.jsxs)("p",{className:"text-2xl font-bold",children:[(0,n.jsx)("span",{className:"text-green-500",children:et.wins}),(0,n.jsx)("span",{className:"text-muted-foreground mx-1",children:"/"}),(0,n.jsx)("span",{className:"text-red-500",children:et.losses})]})]})})]}),(0,n.jsx)(v.Zb,{className:"mb-6",children:(0,n.jsx)(v.aY,{className:"pt-4",children:(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)("input",{type:"text",placeholder:"Search by instrument or ID...",value:D.search,onChange:e=>L(t=>({...t,search:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-background border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring"})]}),(0,n.jsxs)(w.z,{variant:"outline",onClick:()=>M(!_),className:(0,y.cn)("gap-2",_&&"bg-accent"),children:[(0,n.jsx)(m,{className:"h-4 w-4"}),"Filters",ee&&(0,n.jsx)(k.C,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:D.instruments.length+("all"!==D.direction?1:0)+("all"!==D.outcome?1:0)})]}),ee&&(0,n.jsxs)(w.z,{variant:"ghost",size:"sm",onClick:X,children:[(0,n.jsx)(x.Z,{className:"h-4 w-4 mr-1"}),"Clear"]})]}),_&&(0,n.jsxs)("div",{className:"flex flex-wrap gap-4 pt-2 border-t border-border",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Direction"}),(0,n.jsx)("div",{className:"flex gap-1",children:["all","long","short"].map(e=>(0,n.jsx)(w.z,{variant:D.direction===e?"default":"outline",size:"sm",onClick:()=>L(t=>({...t,direction:e})),children:"all"===e?"All":"long"===e?"Long":"Short"},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Outcome"}),(0,n.jsx)("div",{className:"flex gap-1",children:["all","win","loss"].map(e=>(0,n.jsx)(w.z,{variant:D.outcome===e?"default":"outline",size:"sm",onClick:()=>L(t=>({...t,outcome:e})),children:"all"===e?"All":"win"===e?"Winners":"Losers"},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Instruments"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:V.map(e=>(0,n.jsx)(w.z,{variant:D.instruments.includes(e)?"default":"outline",size:"sm",onClick:()=>{L(t=>({...t,instruments:t.instruments.includes(e)?t.instruments.filter(t=>t!==e):[...t.instruments,e]}))},children:e},e))})]})]})]})})}),(0,n.jsx)(v.Zb,{children:(0,n.jsxs)(v.aY,{className:"p-0",children:[(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b border-border",children:[(0,n.jsx)("th",{className:"text-left p-4",children:(0,n.jsxs)("button",{onClick:()=>K("entryTime"),className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground",children:["Date/Time",Q("entryTime")]})}),(0,n.jsx)("th",{className:"text-left p-4",children:(0,n.jsxs)("button",{onClick:()=>K("instrument"),className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground",children:["Instrument",Q("instrument")]})}),(0,n.jsx)("th",{className:"text-left p-4",children:(0,n.jsxs)("button",{onClick:()=>K("direction"),className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground",children:["Direction",Q("direction")]})}),(0,n.jsx)("th",{className:"text-right p-4",children:(0,n.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Entry"})}),(0,n.jsx)("th",{className:"text-right p-4",children:(0,n.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Exit"})}),(0,n.jsx)("th",{className:"text-right p-4",children:(0,n.jsxs)("button",{onClick:()=>K("pnl"),className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground ml-auto",children:["P&L",Q("pnl")]})}),(0,n.jsx)("th",{className:"text-right p-4",children:(0,n.jsxs)("button",{onClick:()=>K("pnlPercent"),className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground ml-auto",children:["P&L %",Q("pnlPercent")]})})]})}),(0,n.jsxs)("tbody",{children:[$.map(e=>{var t;return(0,n.jsxs)("tr",{className:"border-b border-border hover:bg-accent/50 transition-colors cursor-pointer",children:[(0,n.jsx)("td",{className:"p-4",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:new Date(e.entryTime).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.entryTime).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})}),(0,n.jsx)("td",{className:"p-4",children:(0,n.jsx)(k.C,{variant:"outline",children:e.instrument})}),(0,n.jsx)("td",{className:"p-4",children:(0,n.jsxs)(k.C,{variant:"long"===e.direction?"default":"secondary",className:(0,y.cn)("long"===e.direction?"bg-green-500/10 text-green-500 hover:bg-green-500/20":"bg-red-500/10 text-red-500 hover:bg-red-500/20"),children:["long"===e.direction?(0,n.jsx)(h.Z,{className:"h-3 w-3 mr-1"}):(0,n.jsx)(u.Z,{className:"h-3 w-3 mr-1"}),e.direction.toUpperCase()]})}),(0,n.jsx)("td",{className:"p-4 text-right",children:(0,n.jsx)("span",{className:"text-sm",children:e.entryPrice.toLocaleString("en-US",{minimumFractionDigits:2})})}),(0,n.jsx)("td",{className:"p-4 text-right",children:(0,n.jsx)("span",{className:"text-sm",children:(null===(t=e.exitPrice)||void 0===t?void 0:t.toLocaleString("en-US",{minimumFractionDigits:2}))||"-"})}),(0,n.jsx)("td",{className:"p-4 text-right",children:(0,n.jsxs)("span",{className:(0,y.cn)("text-sm font-medium",e.pnl>=0?"text-green-500":"text-red-500"),children:[e.pnl>=0?"+":"",e.currency?q(e.pnl,e.currency):e.pnl.toLocaleString("en-US",{minimumFractionDigits:2})]})}),(0,n.jsx)("td",{className:"p-4 text-right",children:(0,n.jsxs)("span",{className:(0,y.cn)("text-sm font-medium",e.pnlPercent>=0?"text-green-500":"text-red-500"),children:[e.pnlPercent>=0?"+":"",e.pnlPercent.toFixed(2),"%"]})})]},e.id)}),0===$.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:7,className:"p-8 text-center",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsx)(p.Z,{className:"h-8 w-8 text-muted-foreground"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"No trades found"}),ee&&(0,n.jsx)(w.z,{variant:"link",onClick:X,children:"Clear filters"})]})})})]})]})}),H.length>0&&(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-t border-border",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,n.jsxs)("span",{children:["Showing ",G," to ",J," of ",H.length," ","trades"]}),(0,n.jsxs)("select",{value:i,onChange:e=>{z(Number(e.target.value)),s(1)},className:"ml-2 bg-background border border-input rounded-md px-2 py-1 text-sm",children:[(0,n.jsx)("option",{value:10,children:"10 per page"}),(0,n.jsx)("option",{value:20,children:"20 per page"}),(0,n.jsx)("option",{value:50,children:"50 per page"}),(0,n.jsx)("option",{value:100,children:"100 per page"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(w.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>s(1),disabled:1===t,children:(0,n.jsx)(g,{className:"h-4 w-4"})}),(0,n.jsx)(w.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>s(e=>Math.max(1,e-1)),disabled:1===t,children:(0,n.jsx)(f.Z,{className:"h-4 w-4"})}),(0,n.jsxs)("span",{className:"px-3 text-sm",children:["Page ",t," of ",B]}),(0,n.jsx)(w.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>s(e=>Math.min(B,e+1)),disabled:t===B,children:(0,n.jsx)(j.Z,{className:"h-4 w-4"})}),(0,n.jsx)(w.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>s(B),disabled:t===B,children:(0,n.jsx)(N,{className:"h-4 w-4"})})]})]})]})})]})})}}},function(e){e.O(0,[936,673,381,602,68,971,69,744],function(){return e(e.s=85430)}),_N_E=e.O()}]);